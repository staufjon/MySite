<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FluxPrompt - AI Chatbot</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f5f5f5; display: flex; min-height: 100vh; }
    
    /* --- MODIFIED SIDEBAR CSS START --- */
    .sidebar { 
      width: 260px; /* Slightly wider to match screenshot */
      background: #0f172a; /* Darker Navy/Black background */
      color: #fff; 
      display: flex; 
      flex-direction: column; 
      position: fixed; 
      height: 100vh; 
      border-right: 1px solid #1e293b;
    }

    .logo-header {
      padding: 25px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .logo-text {
      font-size: 16px;
      font-weight: 700;
      letter-spacing: 0.5px;
    }
    
    .logo-text span:first-child { color: #fff; }
    .logo-text span:last-child { color: #fbbf24; margin-left: 4px; } /* Orange/Gold Color */

    .hamburger-btn {
      background: #1e293b;
      border: none;
      border-radius: 6px;
      width: 32px;
      height: 32px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      gap: 4px;
      cursor: pointer;
    }
    .hamburger-btn span {
      width: 16px;
      height: 2px;
      background: #94a3b8;
      border-radius: 2px;
    }

    .user-section {
      padding: 10px 20px 30px 20px;
      display: flex;
      flex-direction: column;
      gap: 12px;
      border-bottom: 1px solid #1e293b;
    }

    .user-avatar-large {
      width: 48px;
      height: 48px;
      background: #3b82f6;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      font-weight: 600;
      color: white;
    }

    .user-info-text h3 {
      font-size: 16px;
      font-weight: 600;
      color: #fff;
      margin-bottom: 4px;
    }

    .user-info-text p {
      font-size: 13px;
      color: #64748b;
    }

    .nav-menu {
      padding: 20px 0;
      display: flex;
      flex-direction: column;
      gap: 4px;
      flex: 1;
    }

    .nav-item {
      display: flex;
      align-items: center;
      padding: 12px 20px;
      color: #94a3b8;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.2s;
      text-decoration: none;
      position: relative;
    }

    .nav-item:hover {
      color: #fff;
      background: rgba(255,255,255,0.03);
    }

    /* Active state styling */
    .nav-item.active {
      background: #172033; 
      color: #fff;
      border-left: 3px solid #3b82f6;
    }

    .nav-item svg {
      width: 20px;
      height: 20px;
      margin-right: 12px;
      stroke-width: 2;
    }

    .nav-divider {
      margin-top: auto; /* Push bottom items down */
    }

    .widget-avatar {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      margin-left: auto; /* Push to right */
    }
    /* --- MODIFIED SIDEBAR CSS END --- */
    
    .main { flex: 1; margin-left: 260px; padding: 30px; display: flex; gap: 30px; }
    
    .center-panel { flex: 1; background: #fff; border-radius: 16px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); border: 2px solid #3b82f6; display: flex; flex-direction: column; height: calc(100vh - 60px); overflow: hidden; }
    .panel-header { display: flex; align-items: center; gap: 12px; padding: 20px 25px; border-bottom: 1px solid #e2e8f0; }
    .panel-icon { width: 32px; height: 32px; background: linear-gradient(135deg, #3b82f6, #8b5cf6); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: #fff; }
    .panel-title { font-size: 18px; font-weight: 600; color: #1e293b; }
    .panel-subtitle { font-size: 12px; color: #64748b; }
    .model-badge { margin-left: auto; background: #f1f5f9; padding: 6px 12px; border-radius: 20px; font-size: 11px; color: #64748b; font-weight: 500; }
    .clear-btn { background: none; border: 1px solid #e2e8f0; padding: 6px 12px; border-radius: 8px; font-size: 12px; color: #64748b; cursor: pointer; margin-left: 10px; }
    .clear-btn:hover { background: #f8fafc; color: #1e293b; }
    
    .chat-container { flex: 1; overflow-y: auto; padding: 20px 25px; display: flex; flex-direction: column; gap: 16px; }
    .message { display: flex; gap: 12px; max-width: 85%; animation: fadeIn 0.3s ease; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    .message.user { align-self: flex-end; flex-direction: row-reverse; }
    .message-avatar { width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: 600; flex-shrink: 0; }
    .message.assistant .message-avatar { background: linear-gradient(135deg, #3b82f6, #8b5cf6); color: #fff; }
    .message.user .message-avatar { background: #1e293b; color: #fff; }
    .message-content { padding: 12px 16px; border-radius: 16px; font-size: 14px; line-height: 1.6; }
    .message.assistant .message-content { background: #f1f5f9; color: #1e293b; border-bottom-left-radius: 4px; }
    .message.user .message-content { background: #1e293b; color: #fff; border-bottom-right-radius: 4px; }
    .message-content pre { background: #1e293b; color: #e2e8f0; padding: 12px; border-radius: 8px; overflow-x: auto; margin: 8px 0; font-size: 13px; }
    .message-content code { font-family: 'SF Mono', Monaco, monospace; }
    .message.assistant .message-content pre { background: #1e293b; }
    
    .typing-indicator { display: flex; gap: 4px; padding: 8px 0; }
    .typing-indicator span { width: 8px; height: 8px; background: #94a3b8; border-radius: 50%; animation: bounce 1.4s infinite ease-in-out; }
    .typing-indicator span:nth-child(1) { animation-delay: -0.32s; }
    .typing-indicator span:nth-child(2) { animation-delay: -0.16s; }
    @keyframes bounce { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1); } }
    
    .input-area { padding: 20px 25px; border-top: 1px solid #e2e8f0; background: #fafafa; }
    .file-preview { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 12px; }
    .file-chip { display: flex; align-items: center; gap: 6px; background: #e0e7ff; color: #3730a3; padding: 6px 12px; border-radius: 20px; font-size: 12px; }
    .file-chip button { background: none; border: none; color: #6366f1; cursor: pointer; font-size: 14px; line-height: 1; }
    .input-wrapper { display: flex; gap: 12px; align-items: flex-end; }
    .input-box { flex: 1; display: flex; align-items: flex-end; background: #fff; border: 2px solid #e2e8f0; border-radius: 12px; transition: border-color 0.2s; }
    .input-box:focus-within { border-color: #3b82f6; }
    .input-box textarea { flex: 1; border: none; outline: none; padding: 14px 16px; font-size: 14px; resize: none; max-height: 120px; min-height: 48px; font-family: inherit; background: transparent; }
    .input-actions { display: flex; padding: 8px; gap: 4px; }
    .input-action { width: 36px; height: 36px; border: none; background: none; cursor: pointer; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: #64748b; transition: all 0.2s; }
    .input-action:hover { background: #f1f5f9; color: #3b82f6; }
    .send-btn { width: 48px; height: 48px; background: #1e293b; border: none; border-radius: 12px; cursor: pointer; display: flex; align-items: center; justify-content: center; color: #fff; transition: all 0.2s; }
    .send-btn:hover { background: #334155; transform: scale(1.05); }
    .send-btn:disabled { background: #94a3b8; cursor: not-allowed; transform: none; }
    
    .welcome-msg { text-align: center; padding: 60px 40px; color: #64748b; }
    .welcome-msg h2 { color: #1e293b; font-size: 24px; margin-bottom: 8px; }
    .welcome-msg p { font-size: 14px; margin-bottom: 24px; }
    .suggestions { display: flex; flex-wrap: wrap; gap: 8px; justify-content: center; }
    .suggestion { background: #f1f5f9; border: 1px solid #e2e8f0; padding: 10px 16px; border-radius: 20px; font-size: 13px; color: #475569; cursor: pointer; transition: all 0.2s; }
    .suggestion:hover { background: #e0e7ff; border-color: #6366f1; color: #3730a3; }
    
    .right-panel { width: 280px; display: flex; flex-direction: column; gap: 20px; }
    .card { background: #fff; border-radius: 16px; padding: 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
    .card-title { font-size: 14px; font-weight: 600; color: #1e293b; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }
    .status-dot { width: 8px; height: 8px; background: #10b981; border-radius: 50%; }
    .stat-row { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #f1f5f9; font-size: 13px; }
    .stat-row:last-child { border: none; }
    .stat-label { color: #64748b; }
    .stat-value { color: #1e293b; font-weight: 500; }
    
    .history-item { padding: 12px; background: #f8fafc; border-radius: 10px; margin-bottom: 8px; cursor: pointer; transition: all 0.2s; }
    .history-item:hover { background: #e0e7ff; }
    .history-item h4 { font-size: 13px; color: #1e293b; margin-bottom: 4px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .history-item p { font-size: 11px; color: #64748b; }
    
    svg { width: 18px; height: 18px; }
  </style>
</head>
<body>
  <aside class="sidebar">
    <div class="logo-header">
      <div class="logo-text">
        <span>FLUX</span><span>PROMPT</span>
      </div>
      <button class="hamburger-btn">
        <span></span><span></span><span></span>
      </button>
    </div>

    <div class="user-section">
      <div class="user-avatar-large">JD</div>
      <div class="user-info-text">
        <h3>Name Surname</h3>
        <p>namesurname@gmail.com</p>
      </div>
    </div>
    
    <nav class="nav-menu">
      <div class="nav-item active">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/></svg>
        Settings
      </div>
      
      <div class="nav-item">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"/></svg>
        Notifications
      </div>

      <div class="nav-divider"></div>

      <div class="nav-item">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/></svg>
        Go to Developer Platform
      </div>

      <div class="nav-item">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/></svg>
        Add new widget
        <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix" alt="user" class="widget-avatar">
      </div>
    </nav>
  </aside>
  
  <main class="main">
    <section class="center-panel">
      <div class="panel-header">
        <div class="panel-icon">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/></svg>
        </div>
        <div>
          <div class="panel-title">FluxPrompt AI</div>
          <div class="panel-subtitle">Multi-turn conversation with file support</div>
        </div>
        <div class="model-badge">llama-3.3-70b-versatile</div>
        <button class="clear-btn" onclick="clearChat()">Clear Chat</button>
      </div>
      
      <div class="chat-container" id="chatContainer">
        <div class="welcome-msg" id="welcomeMsg">
          <h2>ðŸ‘‹ Hello! I'm FluxPrompt AI</h2>
          <p>Powered by Llama 3.3 70B via Groq. Ask me anything or upload a file to analyze.</p>
          <div class="suggestions">
            <div class="suggestion" onclick="askSuggestion('Explain quantum computing simply')">Explain quantum computing</div>
            <div class="suggestion" onclick="askSuggestion('Write a Python function to sort a list')">Write Python code</div>
            <div class="suggestion" onclick="askSuggestion('What are the best practices for REST APIs?')">REST API best practices</div>
          </div>
        </div>
      </div>
      
      <div class="input-area">
        <div class="file-preview" id="filePreview"></div>
        <div class="input-wrapper">
          <div class="input-box">
            <textarea id="messageInput" placeholder="Type your message..." rows="1" onkeydown="handleKeyDown(event)"></textarea>
            <div class="input-actions">
              <button class="input-action" onclick="document.getElementById('fileInput').click()" title="Attach file">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"/></svg>
              </button>
              <input type="file" id="fileInput" hidden multiple accept=".txt,.md,.json,.csv,.js,.py,.html,.css" onchange="handleFiles(event)">
            </div>
          </div>
          <button class="send-btn" id="sendBtn" onclick="sendMessage()">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"/></svg>
          </button>
        </div>
      </div>
    </section>
    
    <aside class="right-panel">
      <div class="card">
        <div class="card-title"><span class="status-dot"></span> API Status</div>
        <div class="stat-row"><span class="stat-label">Provider</span><span class="stat-value">Groq</span></div>
        <div class="stat-row"><span class="stat-label">Model</span><span class="stat-value">Llama 3.3 70B</span></div>
        <div class="stat-row"><span class="stat-label">Messages</span><span class="stat-value" id="msgCount">0</span></div>
        <div class="stat-row"><span class="stat-label">Tokens Used</span><span class="stat-value" id="tokenCount">~0</span></div>
      </div>
      <div class="card">
        <div class="card-title">ðŸ’¡ Tips</div>
        <div style="font-size: 12px; color: #64748b; line-height: 1.6;">
          <p>â€¢ Upload .txt, .json, .py, .js files for analysis</p>
          <p style="margin-top: 8px;">â€¢ Multi-turn chat keeps context</p>
          <p style="margin-top: 8px;">â€¢ Press Enter to send, Shift+Enter for new line</p>
        </div>
      </div>
      <div class="card">
        <div class="card-title">ðŸ“œ Chat History</div>
        <div id="historyList">
          <p style="font-size: 12px; color: #94a3b8; text-align: center; padding: 20px 0;">No conversations yet</p>
        </div>
      </div>
    </aside>
  </main>

  <script>
    const API_KEY = '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';
    const API_URL = 'https://api.groq.com/openai/v1/chat/completions';
    const MODEL = 'llama-3.3-70b-versatile';
    
    let messages = [];
    let attachedFiles = [];
    let totalTokens = 0;
    
    const chatContainer = document.getElementById('chatContainer');
    const messageInput = document.getElementById('messageInput');
    const sendBtn = document.getElementById('sendBtn');
    const filePreview = document.getElementById('filePreview');
    const welcomeMsg = document.getElementById('welcomeMsg');
    
    messageInput.addEventListener('input', function() {
      this.style.height = 'auto';
      this.style.height = Math.min(this.scrollHeight, 120) + 'px';
    });
    
    function handleKeyDown(e) {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        sendMessage();
      }
    }
    
    async function handleFiles(e) {
      const files = Array.from(e.target.files);
      for (const file of files) {
        const text = await file.text();
        attachedFiles.push({ name: file.name, content: text });
        renderFilePreview();
      }
      e.target.value = '';
    }
    
    function renderFilePreview() {
      filePreview.innerHTML = attachedFiles.map((f, i) => `
        <div class="file-chip">
          <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>
          ${f.name}
          <button onclick="removeFile(${i})">Ã—</button>
        </div>
      `).join('');
    }
    
    function removeFile(i) {
      attachedFiles.splice(i, 1);
      renderFilePreview();
    }
    
    function addMessage(role, content) {
      if (welcomeMsg) welcomeMsg.style.display = 'none';
      
      const div = document.createElement('div');
      div.className = `message ${role}`;
      div.innerHTML = `
        <div class="message-avatar">${role === 'user' ? 'JD' : 'AI'}</div>
        <div class="message-content">${formatContent(content)}</div>
      `;
      chatContainer.appendChild(div);
      chatContainer.scrollTop = chatContainer.scrollHeight;
    }
    
    function formatContent(text) {
      return text
        .replace(/```(\w*)\n([\s\S]*?)```/g, '<pre><code>$2</code></pre>')
        .replace(/`([^`]+)`/g, '<code style="background:#e2e8f0;padding:2px 6px;border-radius:4px;">$1</code>')
        .replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>')
        .replace(/\n/g, '<br>');
    }
    
    function showTyping() {
      const div = document.createElement('div');
      div.className = 'message assistant';
      div.id = 'typingIndicator';
      div.innerHTML = `
        <div class="message-avatar">AI</div>
        <div class="message-content">
          <div class="typing-indicator"><span></span><span></span><span></span></div>
        </div>
      `;
      chatContainer.appendChild(div);
      chatContainer.scrollTop = chatContainer.scrollHeight;
    }
    
    function removeTyping() {
      const el = document.getElementById('typingIndicator');
      if (el) el.remove();
    }
    
    async function sendMessage() {
      const text = messageInput.value.trim();
      if (!text && attachedFiles.length === 0) return;
      
      let userContent = text;
      if (attachedFiles.length > 0) {
        const fileContents = attachedFiles.map(f => `--- File: ${f.name} ---\n${f.content}`).join('\n\n');
        userContent = fileContents + (text ? `\n\nUser message: ${text}` : '\n\nPlease analyze the above file(s).');
        attachedFiles = [];
        renderFilePreview();
      }
      
      addMessage('user', text || 'Uploaded file(s) for analysis');
      messages.push({ role: 'user', content: userContent });
      
      messageInput.value = '';
      messageInput.style.height = 'auto';
      sendBtn.disabled = true;
      showTyping();
      
      try {
        const res = await fetch(API_URL, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${API_KEY}`
          },
          body: JSON.stringify({
            model: MODEL,
            messages: [
              { role: 'system', content: 'You are FluxPrompt AI, a helpful assistant powered by Llama 3.3. Be concise, friendly, and provide code examples when relevant. Format responses with markdown.' },
              ...messages
            ],
            max_tokens: 2048,
            temperature: 0.7
          })
        });
        
        const data = await res.json();
        removeTyping();
        
        if (data.error) {
          addMessage('assistant', `Error: ${data.error.message}`);
        } else {
          const reply = data.choices[0].message.content;
          messages.push({ role: 'assistant', content: reply });
          addMessage('assistant', reply);
          
          totalTokens += data.usage?.total_tokens || 0;
          document.getElementById('msgCount').textContent = messages.length;
          document.getElementById('tokenCount').textContent = '~' + totalTokens;
        }
      } catch (err) {
        removeTyping();
        addMessage('assistant', `Connection error: ${err.message}`);
      }
      
      sendBtn.disabled = false;
      messageInput.focus();
    }
    
    function askSuggestion(text) {
      messageInput.value = text;
      sendMessage();
    }
    
    function clearChat() {
      messages = [];
      attachedFiles = [];
      totalTokens = 0;
      chatContainer.innerHTML = `
        <div class="welcome-msg" id="welcomeMsg">
          <h2>ðŸ‘‹ Hello! I'm FluxPrompt AI</h2>
          <p>Powered by Llama 3.3 70B via Groq. Ask me anything or upload a file to analyze.</p>
          <div class="suggestions">
            <div class="suggestion" onclick="askSuggestion('Explain quantum computing simply')">Explain quantum computing</div>
            <div class="suggestion" onclick="askSuggestion('Write a Python function to sort a list')">Write Python code</div>
            <div class="suggestion" onclick="askSuggestion('What are the best practices for REST APIs?')">REST API best practices</div>
          </div>
        </div>
      `;
      document.getElementById('msgCount').textContent = '0';
      document.getElementById('tokenCount').textContent = '~0';
      renderFilePreview();
    }
  </script>
</body>
</html>
